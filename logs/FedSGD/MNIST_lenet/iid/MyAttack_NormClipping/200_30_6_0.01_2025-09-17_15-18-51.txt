seed: 4, algorithm: FedSGD, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, batch_size: 32, learning_rate: 0.01, model: lenet, dataset: MNIST, distribution: iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.2, cache_partition: False, num_workers: 0, record_time: False, gpu_idx: [3], my_exp: True, epochs: 200, predict_epochs: 5, predict_alpha: 0.8, hyper_e: 50, softmax_seg: Min, show_sign_flip: True, other_show_3d: False, only_show_last_epoch: True, npy_file_name: 3.1.1, npy_prefix: None, num_clients: 30, num_adv: 6, attack: MyAttack, defense: NormClipping, attack_params: {'aff_open': False, 'moment_open': True, 'record_sign_match': False}, defense_params: {'weakDP': True, 'norm_threshold': 3, 'noise_mean': 0, 'noise_std': 0.002}, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:3, output: ./logs/FedSGD/MNIST_lenet/iid/MyAttack_NormClipping/200_30_6_0.01_2025-09-17_15-18-51.txt

Started on Wed Sep 17 15:18:51 2025
Generating new indices
Doing iid partition
iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  	Train Acc: 0.0990	Train loss: 0.0722	Test Acc: 0.0987	Test loss: 0.0723
Epoch 1  	Train Acc: 0.1125	Train loss: 0.0720	Test Acc: 0.0988	Test loss: 0.0722
Epoch 2  	Train Acc: 0.0917	Train loss: 0.0723	Test Acc: 0.0982	Test loss: 0.0722
Epoch 3  	Train Acc: 0.0833	Train loss: 0.0721	Test Acc: 0.0980	Test loss: 0.0722
Epoch 4  	Train Acc: 0.0781	Train loss: 0.0722	Test Acc: 0.0980	Test loss: 0.0722
Epoch 5  	Train Acc: 0.1052	Train loss: 0.0721	Test Acc: 0.0978	Test loss: 0.0722
Epoch 6  	Train Acc: 0.1073	Train loss: 0.0720	Test Acc: 0.0969	Test loss: 0.0721
Epoch 7  	Train Acc: 0.1083	Train loss: 0.0721	Test Acc: 0.0943	Test loss: 0.0721
Epoch 8  	Train Acc: 0.0969	Train loss: 0.0721	Test Acc: 0.0864	Test loss: 0.0721
Epoch 9  	Train Acc: 0.0906	Train loss: 0.0722	Test Acc: 0.0816	Test loss: 0.0721
Epoch 10 	Train Acc: 0.0635	Train loss: 0.0721	Test Acc: 0.0758	Test loss: 0.0721
Epoch 11 	Train Acc: 0.0740	Train loss: 0.0719	Test Acc: 0.0715	Test loss: 0.0721
Epoch 12 	Train Acc: 0.0604	Train loss: 0.0721	Test Acc: 0.0690	Test loss: 0.0720
Epoch 13 	Train Acc: 0.0677	Train loss: 0.0720	Test Acc: 0.0661	Test loss: 0.0720
Epoch 14 	Train Acc: 0.0583	Train loss: 0.0720	Test Acc: 0.0746	Test loss: 0.0720
Epoch 15 	Train Acc: 0.0781	Train loss: 0.0718	Test Acc: 0.0913	Test loss: 0.0719
Epoch 16 	Train Acc: 0.0833	Train loss: 0.0719	Test Acc: 0.1076	Test loss: 0.0719
Epoch 17 	Train Acc: 0.1042	Train loss: 0.0719	Test Acc: 0.1284	Test loss: 0.0718
Epoch 18 	Train Acc: 0.1135	Train loss: 0.0719	Test Acc: 0.1483	Test loss: 0.0718
Epoch 19 	Train Acc: 0.1531	Train loss: 0.0716	Test Acc: 0.1663	Test loss: 0.0717
Epoch 20 	Train Acc: 0.1615	Train loss: 0.0715	Test Acc: 0.1821	Test loss: 0.0716
Epoch 21 	Train Acc: 0.1573	Train loss: 0.0717	Test Acc: 0.1881	Test loss: 0.0715
Epoch 22 	Train Acc: 0.1896	Train loss: 0.0712	Test Acc: 0.1934	Test loss: 0.0713
Epoch 23 	Train Acc: 0.1854	Train loss: 0.0714	Test Acc: 0.1965	Test loss: 0.0712
Epoch 24 	Train Acc: 0.2198	Train loss: 0.0709	Test Acc: 0.1971	Test loss: 0.0710
Epoch 25 	Train Acc: 0.1865	Train loss: 0.0713	Test Acc: 0.2014	Test loss: 0.0708
Epoch 26 	Train Acc: 0.1969	Train loss: 0.0709	Test Acc: 0.2047	Test loss: 0.0705
Epoch 27 	Train Acc: 0.2083	Train loss: 0.0705	Test Acc: 0.2128	Test loss: 0.0701
Epoch 28 	Train Acc: 0.2073	Train loss: 0.0704	Test Acc: 0.2212	Test loss: 0.0697
Epoch 29 	Train Acc: 0.2240	Train loss: 0.0695	Test Acc: 0.2350	Test loss: 0.0692
Epoch 30 	Train Acc: 0.2365	Train loss: 0.0689	Test Acc: 0.2593	Test loss: 0.0686
Epoch 31 	Train Acc: 0.2625	Train loss: 0.0687	Test Acc: 0.2790	Test loss: 0.0679
Epoch 32 	Train Acc: 0.2875	Train loss: 0.0678	Test Acc: 0.3028	Test loss: 0.0670
Epoch 33 	Train Acc: 0.3000	Train loss: 0.0671	Test Acc: 0.3298	Test loss: 0.0659
Epoch 34 	Train Acc: 0.3167	Train loss: 0.0657	Test Acc: 0.3511	Test loss: 0.0645
Epoch 35 	Train Acc: 0.3458	Train loss: 0.0645	Test Acc: 0.3714	Test loss: 0.0629
Epoch 36 	Train Acc: 0.3438	Train loss: 0.0632	Test Acc: 0.3919	Test loss: 0.0608
Epoch 37 	Train Acc: 0.3906	Train loss: 0.0609	Test Acc: 0.4155	Test loss: 0.0583
Epoch 38 	Train Acc: 0.4062	Train loss: 0.0586	Test Acc: 0.4388	Test loss: 0.0554
Epoch 39 	Train Acc: 0.4417	Train loss: 0.0551	Test Acc: 0.4775	Test loss: 0.0520
Epoch 40 	Train Acc: 0.4531	Train loss: 0.0524	Test Acc: 0.5313	Test loss: 0.0478
Epoch 41 	Train Acc: 0.5281	Train loss: 0.0476	Test Acc: 0.6019	Test loss: 0.0433
Epoch 42 	Train Acc: 0.5802	Train loss: 0.0436	Test Acc: 0.6477	Test loss: 0.0388
Epoch 43 	Train Acc: 0.6146	Train loss: 0.0405	Test Acc: 0.6827	Test loss: 0.0343
Epoch 44 	Train Acc: 0.6760	Train loss: 0.0347	Test Acc: 0.7024	Test loss: 0.0306
Epoch 45 	Train Acc: 0.6917	Train loss: 0.0319	Test Acc: 0.7153	Test loss: 0.0278
Epoch 46 	Train Acc: 0.7083	Train loss: 0.0289	Test Acc: 0.7425	Test loss: 0.0251
Epoch 47 	Train Acc: 0.7302	Train loss: 0.0266	Test Acc: 0.7799	Test loss: 0.0225
Epoch 48 	Train Acc: 0.7646	Train loss: 0.0233	Test Acc: 0.7866	Test loss: 0.0218
Epoch 49 	Train Acc: 0.7917	Train loss: 0.0216	Test Acc: 0.8054	Test loss: 0.0202
Epoch 50 	Train Acc: 0.7958	Train loss: 0.0200	Test Acc: 0.8100	Test loss: 0.0203
Epoch 51 	Train Acc: 0.7979	Train loss: 0.0219	Test Acc: 0.8212	Test loss: 0.0197
Epoch 52 	Train Acc: 0.8156	Train loss: 0.0220	Test Acc: 0.8213	Test loss: 0.0208
Epoch 53 	Train Acc: 0.8240	Train loss: 0.0204	Test Acc: 0.8281	Test loss: 0.0210
Epoch 54 	Train Acc: 0.8146	Train loss: 0.0241	Test Acc: 0.8401	Test loss: 0.0201
Epoch 55 	Train Acc: 0.8229	Train loss: 0.0210	Test Acc: 0.8280	Test loss: 0.0232
Epoch 56 	Train Acc: 0.8115	Train loss: 0.0250	Test Acc: 0.8472	Test loss: 0.0208
Epoch 57 	Train Acc: 0.8510	Train loss: 0.0209	Test Acc: 0.8252	Test loss: 0.0255
Epoch 58 	Train Acc: 0.8167	Train loss: 0.0270	Test Acc: 0.8416	Test loss: 0.0225
Epoch 59 	Train Acc: 0.8354	Train loss: 0.0241	Test Acc: 0.8143	Test loss: 0.0283
Epoch 60 	Train Acc: 0.8052	Train loss: 0.0297	Test Acc: 0.7958	Test loss: 0.0361
Epoch 61 	Train Acc: 0.7719	Train loss: 0.0365	Test Acc: 0.8282	Test loss: 0.0297
Epoch 62 	Train Acc: 0.8050	Train loss: 0.0711	Test Acc: 0.7815	Test loss: 0.0421
Epoch 63 	Train Acc: 0.7802	Train loss: 0.0439	Test Acc: 0.8043	Test loss: 0.0364
Epoch 64 	Train Acc: 0.7865	Train loss: 0.0452	Test Acc: 0.6276	Test loss: 0.0918
Epoch 65 	Train Acc: 0.6125	Train loss: 0.0867	Test Acc: 0.6703	Test loss: 0.1409
Epoch 66 	Train Acc: 0.6781	Train loss: 0.1543	Test Acc: 0.6355	Test loss: 0.1618
Epoch 67 	Train Acc: 0.6635	Train loss: 0.1481	Test Acc: 0.6648	Test loss: 0.1082
Epoch 68 	Train Acc: 0.6823	Train loss: 0.1112	Test Acc: 0.5764	Test loss: 0.0820
Epoch 69 	Train Acc: 0.5646	Train loss: 0.0858	Test Acc: 0.5298	Test loss: 0.0644
Epoch 70 	Train Acc: 0.5260	Train loss: 0.0668	Test Acc: 0.5038	Test loss: 0.0646
Epoch 71 	Train Acc: 0.5219	Train loss: 0.0651	Test Acc: 0.6448	Test loss: 0.0434
Epoch 72 	Train Acc: 0.6510	Train loss: 0.0406	Test Acc: 0.6484	Test loss: 0.0565
Epoch 73 	Train Acc: 0.6708	Train loss: 0.0533	Test Acc: 0.6623	Test loss: 0.0602
Epoch 74 	Train Acc: 0.6396	Train loss: 0.0613	Test Acc: 0.5485	Test loss: 0.0725
Epoch 75 	Train Acc: 0.5458	Train loss: 0.0734	Test Acc: 0.4859	Test loss: 0.0966
Epoch 76 	Train Acc: 0.4990	Train loss: 0.0937	Test Acc: 0.6184	Test loss: 0.0617
Epoch 77 	Train Acc: 0.6094	Train loss: 0.0630	Test Acc: 0.6756	Test loss: 0.0504
Epoch 78 	Train Acc: 0.6854	Train loss: 0.0496	Test Acc: 0.6321	Test loss: 0.0611
Epoch 79 	Train Acc: 0.6333	Train loss: 0.0601	Test Acc: 0.6062	Test loss: 0.0671
Epoch 80 	Train Acc: 0.6031	Train loss: 0.0692	Test Acc: 0.6155	Test loss: 0.0587
Epoch 81 	Train Acc: 0.6104	Train loss: 0.0577	Test Acc: 0.5980	Test loss: 0.0584
Epoch 82 	Train Acc: 0.5844	Train loss: 0.0597	Test Acc: 0.5445	Test loss: 0.0692
Epoch 83 	Train Acc: 0.5281	Train loss: 0.0700	Test Acc: 0.4961	Test loss: 0.0804
Epoch 84 	Train Acc: 0.4677	Train loss: 0.0869	Test Acc: 0.4975	Test loss: 0.0794
Epoch 85 	Train Acc: 0.4938	Train loss: 0.0795	Test Acc: 0.5362	Test loss: 0.0697
Epoch 86 	Train Acc: 0.5250	Train loss: 0.0737	Test Acc: 0.5881	Test loss: 0.0615
Epoch 87 	Train Acc: 0.6042	Train loss: 0.0646	Test Acc: 0.6219	Test loss: 0.0623
Epoch 88 	Train Acc: 0.6146	Train loss: 0.0599	Test Acc: 0.6432	Test loss: 0.0648
Epoch 89 	Train Acc: 0.6219	Train loss: 0.0670	Test Acc: 0.6781	Test loss: 0.0610
Epoch 90 	Train Acc: 0.6615	Train loss: 0.0648	Test Acc: 0.7080	Test loss: 0.0543
Epoch 91 	Train Acc: 0.6802	Train loss: 0.0560	Test Acc: 0.7193	Test loss: 0.0529
Epoch 92 	Train Acc: 0.6906	Train loss: 0.0542	Test Acc: 0.7135	Test loss: 0.0588
Epoch 93 	Train Acc: 0.7156	Train loss: 0.0581	Test Acc: 0.7055	Test loss: 0.0650
Epoch 94 	Train Acc: 0.6948	Train loss: 0.0655	Test Acc: 0.7040	Test loss: 0.0675
Epoch 95 	Train Acc: 0.6948	Train loss: 0.0740	Test Acc: 0.7051	Test loss: 0.0667
Epoch 96 	Train Acc: 0.7240	Train loss: 0.0665	Test Acc: 0.7100	Test loss: 0.0616
Epoch 97 	Train Acc: 0.7302	Train loss: 0.0490	Test Acc: 0.7250	Test loss: 0.0561
Epoch 98 	Train Acc: 0.7240	Train loss: 0.0557	Test Acc: 0.7288	Test loss: 0.0548
Epoch 99 	Train Acc: 0.7271	Train loss: 0.0580	Test Acc: 0.7263	Test loss: 0.0570
Epoch 100	Train Acc: 0.7125	Train loss: 0.0674	Test Acc: 0.7467	Test loss: 0.0544
Epoch 101	Train Acc: 0.7458	Train loss: 0.0570	Test Acc: 0.7588	Test loss: 0.0512
Epoch 102	Train Acc: 0.7729	Train loss: 0.0514	Test Acc: 0.7726	Test loss: 0.0480
Epoch 103	Train Acc: 0.7510	Train loss: 0.0501	Test Acc: 0.7746	Test loss: 0.0470
Epoch 104	Train Acc: 0.7688	Train loss: 0.0481	Test Acc: 0.7703	Test loss: 0.0478
Epoch 105	Train Acc: 0.7385	Train loss: 0.0581	Test Acc: 0.7655	Test loss: 0.0483
Epoch 106	Train Acc: 0.7469	Train loss: 0.0578	Test Acc: 0.7623	Test loss: 0.0497
Epoch 107	Train Acc: 0.7458	Train loss: 0.0561	Test Acc: 0.7551	Test loss: 0.0511
Epoch 108	Train Acc: 0.7510	Train loss: 0.0557	Test Acc: 0.7584	Test loss: 0.0522
Epoch 109	Train Acc: 0.7406	Train loss: 0.0535	Test Acc: 0.7664	Test loss: 0.0524
Epoch 110	Train Acc: 0.7573	Train loss: 0.0565	Test Acc: 0.7741	Test loss: 0.0548
Epoch 111	Train Acc: 0.7635	Train loss: 0.0609	Test Acc: 0.7842	Test loss: 0.0594
Epoch 112	Train Acc: 0.7562	Train loss: 0.0631	Test Acc: 0.7943	Test loss: 0.0610
Epoch 113	Train Acc: 0.7760	Train loss: 0.0649	Test Acc: 0.8031	Test loss: 0.0581
