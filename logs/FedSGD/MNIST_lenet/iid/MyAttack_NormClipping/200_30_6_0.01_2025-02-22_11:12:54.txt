seed: 4, algorithm: FedSGD, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, batch_size: 64, learning_rate: 0.01, model: lenet, dataset: MNIST, distribution: iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.2, cache_partition: False, gpu_idx: [0], num_workers: 0, record_time: False, my_exp: True, show_3d: False, epochs: 200, predict_epochs: 5, predict_alpha: 0.8, num_clients: 30, num_adv: 6, attack: MyAttack, defense: NormClipping, attack_params: None, defense_params: {'weakDP': True, 'norm_threshold': 3, 'noise_mean': 0, 'noise_std': 0.002}, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:0, output: ./logs/FedSGD/MNIST_lenet/iid/MyAttack_NormClipping/200_30_6_0.01_2025-02-22_11:12:54.txt

Started on Sat Feb 22 11:12:54 2025
Generating new indices
Doing iid partition
iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  	Train Acc: 0.1057	Train loss: 0.0360	Test Acc: 0.0982	Test loss: 0.0362
Epoch 1  	Train Acc: 0.0875	Train loss: 0.0361	Test Acc: 0.0980	Test loss: 0.0362
Epoch 2  	Train Acc: 0.0917	Train loss: 0.0361	Test Acc: 0.0980	Test loss: 0.0362
Epoch 3  	Train Acc: 0.1083	Train loss: 0.0360	Test Acc: 0.0979	Test loss: 0.0362
Epoch 4  	Train Acc: 0.1016	Train loss: 0.0361	Test Acc: 0.0984	Test loss: 0.0362
Epoch 5  	Train Acc: 0.0885	Train loss: 0.0361	Test Acc: 0.0985	Test loss: 0.0362
Epoch 6  	Train Acc: 0.0979	Train loss: 0.0361	Test Acc: 0.0984	Test loss: 0.0362
Epoch 7  	Train Acc: 0.0958	Train loss: 0.0361	Test Acc: 0.0941	Test loss: 0.0362
Epoch 8  	Train Acc: 0.0953	Train loss: 0.0360	Test Acc: 0.0945	Test loss: 0.0362
Epoch 9  	Train Acc: 0.1042	Train loss: 0.0360	Test Acc: 0.0943	Test loss: 0.0362
Epoch 10 	Train Acc: 0.1005	Train loss: 0.0360	Test Acc: 0.0939	Test loss: 0.0361
Epoch 11 	Train Acc: 0.1010	Train loss: 0.0360	Test Acc: 0.0842	Test loss: 0.0361
Epoch 12 	Train Acc: 0.0792	Train loss: 0.0360	Test Acc: 0.0906	Test loss: 0.0361
Epoch 13 	Train Acc: 0.0849	Train loss: 0.0360	Test Acc: 0.0791	Test loss: 0.0361
Epoch 14 	Train Acc: 0.0813	Train loss: 0.0360	Test Acc: 0.0671	Test loss: 0.0361
Epoch 15 	Train Acc: 0.0714	Train loss: 0.0359	Test Acc: 0.0740	Test loss: 0.0361
Epoch 16 	Train Acc: 0.0688	Train loss: 0.0359	Test Acc: 0.0849	Test loss: 0.0360
Epoch 17 	Train Acc: 0.0828	Train loss: 0.0359	Test Acc: 0.0947	Test loss: 0.0360
Epoch 18 	Train Acc: 0.0906	Train loss: 0.0359	Test Acc: 0.1058	Test loss: 0.0360
Epoch 19 	Train Acc: 0.1047	Train loss: 0.0358	Test Acc: 0.1220	Test loss: 0.0360
Epoch 20 	Train Acc: 0.1141	Train loss: 0.0358	Test Acc: 0.1305	Test loss: 0.0359
Epoch 21 	Train Acc: 0.1297	Train loss: 0.0358	Test Acc: 0.1226	Test loss: 0.0359
Epoch 22 	Train Acc: 0.1167	Train loss: 0.0357	Test Acc: 0.1287	Test loss: 0.0358
Epoch 23 	Train Acc: 0.1172	Train loss: 0.0357	Test Acc: 0.1390	Test loss: 0.0358
Epoch 24 	Train Acc: 0.1380	Train loss: 0.0357	Test Acc: 0.1296	Test loss: 0.0358
Epoch 25 	Train Acc: 0.1396	Train loss: 0.0356	Test Acc: 0.1400	Test loss: 0.0357
Epoch 26 	Train Acc: 0.1443	Train loss: 0.0356	Test Acc: 0.1535	Test loss: 0.0356
Epoch 27 	Train Acc: 0.1516	Train loss: 0.0355	Test Acc: 0.1630	Test loss: 0.0355
Epoch 28 	Train Acc: 0.1656	Train loss: 0.0353	Test Acc: 0.1701	Test loss: 0.0354
Epoch 29 	Train Acc: 0.1599	Train loss: 0.0354	Test Acc: 0.1797	Test loss: 0.0353
Epoch 30 	Train Acc: 0.1797	Train loss: 0.0352	Test Acc: 0.1934	Test loss: 0.0352
Epoch 31 	Train Acc: 0.1943	Train loss: 0.1482	Test Acc: 0.2168	Test loss: 0.0350
Epoch 32 	Train Acc: 0.1969	Train loss: 0.0349	Test Acc: 0.2462	Test loss: 0.0348
Epoch 33 	Train Acc: 0.2432	Train loss: 0.0347	Test Acc: 0.2635	Test loss: 0.0345
Epoch 34 	Train Acc: 0.2599	Train loss: 0.0344	Test Acc: 0.2802	Test loss: 0.0343
Epoch 35 	Train Acc: 0.2599	Train loss: 0.0342	Test Acc: 0.2983	Test loss: 0.0340
Epoch 36 	Train Acc: 0.2927	Train loss: 0.0338	Test Acc: 0.3163	Test loss: 0.0336
Epoch 37 	Train Acc: 0.2932	Train loss: 0.0336	Test Acc: 0.3385	Test loss: 0.0333
Epoch 38 	Train Acc: 0.3208	Train loss: 0.0333	Test Acc: 0.3681	Test loss: 0.0329
Epoch 39 	Train Acc: 0.3578	Train loss: 0.0329	Test Acc: 0.3948	Test loss: 0.0324
Epoch 40 	Train Acc: 0.3786	Train loss: 0.0325	Test Acc: 0.4171	Test loss: 0.0319
Epoch 41 	Train Acc: 0.3849	Train loss: 0.0321	Test Acc: 0.4455	Test loss: 0.0313
Epoch 42 	Train Acc: 0.4474	Train loss: 0.0314	Test Acc: 0.4730	Test loss: 0.0307
Epoch 43 	Train Acc: 0.4615	Train loss: 0.0308	Test Acc: 0.4870	Test loss: 0.0295
Epoch 44 	Train Acc: 0.4724	Train loss: 0.0296	Test Acc: 0.5037	Test loss: 0.0286
Epoch 45 	Train Acc: 0.5062	Train loss: 0.0286	Test Acc: 0.5234	Test loss: 0.0272
Epoch 46 	Train Acc: 0.5135	Train loss: 0.0272	Test Acc: 0.5436	Test loss: 0.0255
Epoch 47 	Train Acc: 0.5161	Train loss: 0.0259	Test Acc: 0.5627	Test loss: 0.0237
Epoch 48 	Train Acc: 0.5469	Train loss: 0.0242	Test Acc: 0.5972	Test loss: 0.0221
Epoch 49 	Train Acc: 0.5974	Train loss: 0.0222	Test Acc: 0.6320	Test loss: 0.0205
Epoch 50 	Train Acc: 0.6255	Train loss: 0.0210	Test Acc: 0.6585	Test loss: 0.0189
Epoch 51 	Train Acc: 0.6609	Train loss: 0.0186	Test Acc: 0.6777	Test loss: 0.0173
Epoch 52 	Train Acc: 0.6521	Train loss: 0.0180	Test Acc: 0.6960	Test loss: 0.0159
Epoch 53 	Train Acc: 0.6823	Train loss: 0.0168	Test Acc: 0.7188	Test loss: 0.0143
Epoch 54 	Train Acc: 0.7141	Train loss: 0.0145	Test Acc: 0.7399	Test loss: 0.0132
Epoch 55 	Train Acc: 0.7349	Train loss: 0.0138	Test Acc: 0.7519	Test loss: 0.0122
Epoch 56 	Train Acc: 0.7411	Train loss: 0.0131	Test Acc: 0.7659	Test loss: 0.0114
Epoch 57 	Train Acc: 0.7677	Train loss: 0.0117	Test Acc: 0.7776	Test loss: 0.0108
Epoch 58 	Train Acc: 0.7740	Train loss: 0.0109	Test Acc: 0.7934	Test loss: 0.0102
Epoch 59 	Train Acc: 0.7906	Train loss: 0.0106	Test Acc: 0.8042	Test loss: 0.0098
Epoch 60 	Train Acc: 0.8068	Train loss: 0.0101	Test Acc: 0.8089	Test loss: 0.0096
Epoch 61 	Train Acc: 0.7906	Train loss: 0.0106	Test Acc: 0.8219	Test loss: 0.0091
Epoch 62 	Train Acc: 0.7990	Train loss: 0.0102	Test Acc: 0.8315	Test loss: 0.0089
Epoch 63 	Train Acc: 0.8307	Train loss: 0.0353	Test Acc: 0.8320	Test loss: 0.0090
Epoch 64 	Train Acc: 0.8333	Train loss: 0.0087	Test Acc: 0.8458	Test loss: 0.0086
Epoch 65 	Train Acc: 0.8380	Train loss: 0.0087	Test Acc: 0.8524	Test loss: 0.0084
Epoch 66 	Train Acc: 0.8599	Train loss: 0.0081	Test Acc: 0.8580	Test loss: 0.0083
Epoch 67 	Train Acc: 0.8521	Train loss: 0.0084	Test Acc: 0.8629	Test loss: 0.0081
Epoch 68 	Train Acc: 0.8427	Train loss: 0.0088	Test Acc: 0.8675	Test loss: 0.0083
Epoch 69 	Train Acc: 0.8443	Train loss: 0.0095	Test Acc: 0.8668	Test loss: 0.0085
Epoch 70 	Train Acc: 0.8620	Train loss: 0.0085	Test Acc: 0.8684	Test loss: 0.0085
Epoch 71 	Train Acc: 0.8708	Train loss: 0.0084	Test Acc: 0.8701	Test loss: 0.0086
Epoch 72 	Train Acc: 0.8547	Train loss: 0.0092	Test Acc: 0.8685	Test loss: 0.0084
Epoch 73 	Train Acc: 0.8542	Train loss: 0.0095	Test Acc: 0.8710	Test loss: 0.0083
Epoch 74 	Train Acc: 0.8661	Train loss: 0.0092	Test Acc: 0.8710	Test loss: 0.0085
Epoch 75 	Train Acc: 0.8526	Train loss: 0.0104	Test Acc: 0.8655	Test loss: 0.0087
Epoch 76 	Train Acc: 0.8365	Train loss: 0.0097	Test Acc: 0.8664	Test loss: 0.0090
Epoch 77 	Train Acc: 0.8594	Train loss: 0.0093	Test Acc: 0.8333	Test loss: 0.0122
Epoch 78 	Train Acc: 0.8094	Train loss: 0.0134	Test Acc: 0.8587	Test loss: 0.0101
Epoch 79 	Train Acc: 0.8479	Train loss: 0.0108	Test Acc: 0.8298	Test loss: 0.0134
Epoch 80 	Train Acc: 0.8380	Train loss: 0.0122	Test Acc: 0.8527	Test loss: 0.0103
Epoch 81 	Train Acc: 0.8427	Train loss: 0.0103	Test Acc: 0.8701	Test loss: 0.0095
Epoch 82 	Train Acc: 0.8641	Train loss: 0.0109	Test Acc: 0.8528	Test loss: 0.0106
Epoch 83 	Train Acc: 0.8557	Train loss: 0.0105	Test Acc: 0.8599	Test loss: 0.0102
Epoch 84 	Train Acc: 0.8469	Train loss: 0.0103	Test Acc: 0.8795	Test loss: 0.0091
Epoch 85 	Train Acc: 0.8755	Train loss: 0.0094	Test Acc: 0.8723	Test loss: 0.0104
Epoch 86 	Train Acc: 0.8682	Train loss: 0.0100	Test Acc: 0.8667	Test loss: 0.0107
Epoch 87 	Train Acc: 0.8578	Train loss: 0.0118	Test Acc: 0.8796	Test loss: 0.0093
Epoch 88 	Train Acc: 0.8745	Train loss: 0.0089	Test Acc: 0.8715	Test loss: 0.0101
Epoch 89 	Train Acc: 0.8781	Train loss: 0.0106	Test Acc: 0.8708	Test loss: 0.0097
Epoch 90 	Train Acc: 0.8667	Train loss: 0.0107	Test Acc: 0.8738	Test loss: 0.0095
Epoch 91 	Train Acc: 0.8771	Train loss: 0.0087	Test Acc: 0.8654	Test loss: 0.0100
Epoch 92 	Train Acc: 0.8661	Train loss: 0.0095	Test Acc: 0.8598	Test loss: 0.0103
Epoch 93 	Train Acc: 0.8448	Train loss: 0.0122	Test Acc: 0.8655	Test loss: 0.0099
Epoch 94 	Train Acc: 0.8609	Train loss: 0.0101	Test Acc: 0.8580	Test loss: 0.0106
Epoch 95 	Train Acc: 0.8539	Train loss: 0.0459	Test Acc: 0.8535	Test loss: 0.0108
Epoch 96 	Train Acc: 0.8630	Train loss: 0.0102	Test Acc: 0.8677	Test loss: 0.0097
Epoch 97 	Train Acc: 0.8594	Train loss: 0.0102	Test Acc: 0.8593	Test loss: 0.0105
Epoch 98 	Train Acc: 0.8667	Train loss: 0.0102	Test Acc: 0.8608	Test loss: 0.0103
Epoch 99 	Train Acc: 0.8578	Train loss: 0.0103	Test Acc: 0.8596	Test loss: 0.0100
Epoch 100	Train Acc: 0.8677	Train loss: 0.0094	Test Acc: 0.8376	Test loss: 0.0120
Epoch 101	Train Acc: 0.8224	Train loss: 0.0127	Test Acc: 0.8575	Test loss: 0.0106
Epoch 102	Train Acc: 0.8630	Train loss: 0.0087	Test Acc: 0.8565	Test loss: 0.0106
Epoch 103	Train Acc: 0.8677	Train loss: 0.0093	Test Acc: 0.8583	Test loss: 0.0104
Epoch 104	Train Acc: 0.8521	Train loss: 0.0108	Test Acc: 0.8579	Test loss: 0.0103
Epoch 105	Train Acc: 0.8521	Train loss: 0.0115	Test Acc: 0.8572	Test loss: 0.0103
Epoch 106	Train Acc: 0.8625	Train loss: 0.0106	Test Acc: 0.8552	Test loss: 0.0105
Epoch 107	Train Acc: 0.8620	Train loss: 0.0099	Test Acc: 0.8534	Test loss: 0.0111
Epoch 108	Train Acc: 0.8620	Train loss: 0.0109	Test Acc: 0.8578	Test loss: 0.0108
Epoch 109	Train Acc: 0.8500	Train loss: 0.0120	Test Acc: 0.8543	Test loss: 0.0111
Epoch 110	Train Acc: 0.8448	Train loss: 0.0122	Test Acc: 0.8547	Test loss: 0.0111
Epoch 111	Train Acc: 0.8380	Train loss: 0.0128	Test Acc: 0.8528	Test loss: 0.0113
Epoch 112	Train Acc: 0.8385	Train loss: 0.0130	Test Acc: 0.8543	Test loss: 0.0114
Epoch 113	Train Acc: 0.8464	Train loss: 0.0122	Test Acc: 0.8569	Test loss: 0.0114
Epoch 114	Train Acc: 0.8625	Train loss: 0.0109	Test Acc: 0.8616	Test loss: 0.0114
Epoch 115	Train Acc: 0.8609	Train loss: 0.0114	Test Acc: 0.8647	Test loss: 0.0115
Epoch 116	Train Acc: 0.8562	Train loss: 0.0119	Test Acc: 0.8637	Test loss: 0.0117
Epoch 117	Train Acc: 0.8453	Train loss: 0.0141	Test Acc: 0.8619	Test loss: 0.0119
Epoch 118	Train Acc: 0.8667	Train loss: 0.0114	Test Acc: 0.8622	Test loss: 0.0120
Epoch 119	Train Acc: 0.8620	Train loss: 0.0127	Test Acc: 0.8607	Test loss: 0.0121
Epoch 120	Train Acc: 0.8536	Train loss: 0.0130	Test Acc: 0.8653	Test loss: 0.0122
Epoch 121	Train Acc: 0.8573	Train loss: 0.0133	Test Acc: 0.8619	Test loss: 0.0126
Epoch 122	Train Acc: 0.8583	Train loss: 0.0131	Test Acc: 0.8611	Test loss: 0.0126
Epoch 123	Train Acc: 0.8635	Train loss: 0.0118	Test Acc: 0.8635	Test loss: 0.0127
Epoch 124	Train Acc: 0.8708	Train loss: 0.0124	Test Acc: 0.8666	Test loss: 0.0128
Epoch 125	Train Acc: 0.8578	Train loss: 0.0144	Test Acc: 0.8644	Test loss: 0.0134
Epoch 126	Train Acc: 0.8562	Train loss: 0.0160	Test Acc: 0.8626	Test loss: 0.0133
Epoch 127	Train Acc: 0.8203	Train loss: 0.0677	Test Acc: 0.8563	Test loss: 0.0139
Epoch 128	Train Acc: 0.8500	Train loss: 0.0147	Test Acc: 0.8634	Test loss: 0.0145
Epoch 129	Train Acc: 0.8740	Train loss: 0.0136	Test Acc: 0.8706	Test loss: 0.0143
Epoch 130	Train Acc: 0.8714	Train loss: 0.0129	Test Acc: 0.8696	Test loss: 0.0139
Epoch 131	Train Acc: 0.8688	Train loss: 0.0145	Test Acc: 0.8713	Test loss: 0.0142
Epoch 132	Train Acc: 0.8557	Train loss: 0.0160	Test Acc: 0.8784	Test loss: 0.0138
Epoch 133	Train Acc: 0.8812	Train loss: 0.0145	Test Acc: 0.8711	Test loss: 0.0144
Epoch 134	Train Acc: 0.8792	Train loss: 0.0135	Test Acc: 0.8687	Test loss: 0.0150
Epoch 135	Train Acc: 0.8672	Train loss: 0.0151	Test Acc: 0.8763	Test loss: 0.0143
Epoch 136	Train Acc: 0.8828	Train loss: 0.0142	Test Acc: 0.8764	Test loss: 0.0139
Epoch 137	Train Acc: 0.8859	Train loss: 0.0127	Test Acc: 0.8726	Test loss: 0.0138
Epoch 138	Train Acc: 0.8792	Train loss: 0.0132	Test Acc: 0.8749	Test loss: 0.0139
Epoch 139	Train Acc: 0.8776	Train loss: 0.0133	Test Acc: 0.8718	Test loss: 0.0139
Epoch 140	Train Acc: 0.8776	Train loss: 0.0135	Test Acc: 0.8701	Test loss: 0.0135
Epoch 141	Train Acc: 0.8557	Train loss: 0.0158	Test Acc: 0.8819	Test loss: 0.0126
Epoch 142	Train Acc: 0.8854	Train loss: 0.0126	Test Acc: 0.8920	Test loss: 0.0117
Epoch 143	Train Acc: 0.8891	Train loss: 0.0126	Test Acc: 0.8922	Test loss: 0.0114
Epoch 144	Train Acc: 0.8781	Train loss: 0.0128	Test Acc: 0.8914	Test loss: 0.0113
Epoch 145	Train Acc: 0.8891	Train loss: 0.0106	Test Acc: 0.8901	Test loss: 0.0108
Epoch 146	Train Acc: 0.8797	Train loss: 0.0123	Test Acc: 0.8800	Test loss: 0.0114
Epoch 147	Train Acc: 0.8766	Train loss: 0.0123	Test Acc: 0.8812	Test loss: 0.0115
Epoch 148	Train Acc: 0.8823	Train loss: 0.0139	Test Acc: 0.8825	Test loss: 0.0108
Epoch 149	Train Acc: 0.8729	Train loss: 0.0138	Test Acc: 0.8950	Test loss: 0.0103
Epoch 150	Train Acc: 0.8844	Train loss: 0.0128	Test Acc: 0.8909	Test loss: 0.0109
Epoch 151	Train Acc: 0.8828	Train loss: 0.0131	Test Acc: 0.8912	Test loss: 0.0113
Epoch 152	Train Acc: 0.9000	Train loss: 0.0128	Test Acc: 0.8959	Test loss: 0.0106
Epoch 153	Train Acc: 0.9005	Train loss: 0.0103	Test Acc: 0.9057	Test loss: 0.0097
Epoch 154	Train Acc: 0.8990	Train loss: 0.0117	Test Acc: 0.9040	Test loss: 0.0095
Epoch 155	Train Acc: 0.8885	Train loss: 0.0114	Test Acc: 0.8997	Test loss: 0.0101
Epoch 156	Train Acc: 0.8943	Train loss: 0.0108	Test Acc: 0.9082	Test loss: 0.0094
Epoch 157	Train Acc: 0.8990	Train loss: 0.0111	Test Acc: 0.8994	Test loss: 0.0098
Epoch 158	Train Acc: 0.8964	Train loss: 0.0101	Test Acc: 0.9034	Test loss: 0.0094
Epoch 159	Train Acc: 0.8927	Train loss: 0.0439	Test Acc: 0.8990	Test loss: 0.0097
Epoch 160	Train Acc: 0.8917	Train loss: 0.0108	Test Acc: 0.9011	Test loss: 0.0100
Epoch 161	Train Acc: 0.9036	Train loss: 0.0098	Test Acc: 0.9066	Test loss: 0.0097
Epoch 162	Train Acc: 0.9057	Train loss: 0.0108	Test Acc: 0.9114	Test loss: 0.0095
Epoch 163	Train Acc: 0.9036	Train loss: 0.0100	Test Acc: 0.8993	Test loss: 0.0100
Epoch 164	Train Acc: 0.8974	Train loss: 0.0106	Test Acc: 0.9113	Test loss: 0.0092
Epoch 165	Train Acc: 0.8906	Train loss: 0.0110	Test Acc: 0.9143	Test loss: 0.0090
Epoch 166	Train Acc: 0.9057	Train loss: 0.0096	Test Acc: 0.9176	Test loss: 0.0088
Epoch 167	Train Acc: 0.9198	Train loss: 0.0086	Test Acc: 0.9132	Test loss: 0.0088
Epoch 168	Train Acc: 0.9073	Train loss: 0.0104	Test Acc: 0.9175	Test loss: 0.0086
Epoch 169	Train Acc: 0.9141	Train loss: 0.0088	Test Acc: 0.9167	Test loss: 0.0084
Epoch 170	Train Acc: 0.9255	Train loss: 0.0079	Test Acc: 0.9134	Test loss: 0.0086
Epoch 171	Train Acc: 0.9031	Train loss: 0.0086	Test Acc: 0.9113	Test loss: 0.0083
Epoch 172	Train Acc: 0.9135	Train loss: 0.0096	Test Acc: 0.9148	Test loss: 0.0082
Epoch 173	Train Acc: 0.9187	Train loss: 0.0084	Test Acc: 0.9110	Test loss: 0.0084
Epoch 174	Train Acc: 0.9109	Train loss: 0.0085	Test Acc: 0.9120	Test loss: 0.0085
