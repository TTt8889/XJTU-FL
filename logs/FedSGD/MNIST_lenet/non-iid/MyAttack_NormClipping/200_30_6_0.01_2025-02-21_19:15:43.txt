seed: 4, algorithm: FedSGD, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, batch_size: 64, learning_rate: 0.01, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.2, cache_partition: False, gpu_idx: [2], num_workers: 0, record_time: False, my_exp: True, show_3d: False, epochs: 200, predict_epochs: 1, predict_alpha: 0.8, num_clients: 30, num_adv: 6, attack: MyAttack, defense: NormClipping, attack_params: None, defense_params: {'weakDP': True, 'norm_threshold': 3, 'noise_mean': 0, 'noise_std': 0.002}, benchmark: False, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cuda:2, output: ./logs/FedSGD/MNIST_lenet/non-iid/MyAttack_NormClipping/200_30_6_0.01_2025-02-21_19:15:43.txt

Started on Fri Feb 21 19:15:43 2025
Generating new indices
Doing non-iid partition
dirichlet alpha: 0.2
non-iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  	Train Acc: 0.1026	Train loss: 0.0360	Test Acc: 0.1077	Test loss: 0.0362
Epoch 1  	Train Acc: 0.1031	Train loss: 0.0360	Test Acc: 0.1098	Test loss: 0.0362
Epoch 2  	Train Acc: 0.1099	Train loss: 0.0360	Test Acc: 0.1120	Test loss: 0.0362
Epoch 3  	Train Acc: 0.1339	Train loss: 0.0360	Test Acc: 0.1163	Test loss: 0.0362
Epoch 4  	Train Acc: 0.1302	Train loss: 0.0360	Test Acc: 0.1239	Test loss: 0.0361
Epoch 5  	Train Acc: 0.1292	Train loss: 0.0359	Test Acc: 0.1343	Test loss: 0.0361
Epoch 6  	Train Acc: 0.1375	Train loss: 0.0424	Test Acc: 0.1411	Test loss: 0.0361
Epoch 7  	Train Acc: 0.1646	Train loss: 0.0359	Test Acc: 0.1497	Test loss: 0.0361
Epoch 8  	Train Acc: 0.1630	Train loss: 0.0359	Test Acc: 0.1568	Test loss: 0.0361
Epoch 9  	Train Acc: 0.1828	Train loss: 0.0359	Test Acc: 0.1629	Test loss: 0.0361
Epoch 10 	Train Acc: 0.1824	Train loss: 0.0360	Test Acc: 0.1684	Test loss: 0.0361
Epoch 11 	Train Acc: 0.1854	Train loss: 0.0359	Test Acc: 0.1696	Test loss: 0.0361
Epoch 12 	Train Acc: 0.1984	Train loss: 0.0359	Test Acc: 0.1659	Test loss: 0.0361
Epoch 13 	Train Acc: 0.2000	Train loss: 0.0423	Test Acc: 0.1613	Test loss: 0.0361
Epoch 14 	Train Acc: 0.2071	Train loss: 0.0374	Test Acc: 0.1517	Test loss: 0.0360
Epoch 15 	Train Acc: 0.1953	Train loss: 0.0358	Test Acc: 0.1440	Test loss: 0.0360
Epoch 16 	Train Acc: 0.1777	Train loss: 0.0368	Test Acc: 0.1325	Test loss: 0.0360
Epoch 17 	Train Acc: 0.1784	Train loss: 0.0407	Test Acc: 0.1218	Test loss: 0.0360
Epoch 18 	Train Acc: 0.1646	Train loss: 0.0496	Test Acc: 0.1156	Test loss: 0.0360
Epoch 19 	Train Acc: 0.1341	Train loss: 0.0382	Test Acc: 0.1088	Test loss: 0.0360
Epoch 20 	Train Acc: 0.1437	Train loss: 0.0424	Test Acc: 0.1068	Test loss: 0.0360
Epoch 21 	Train Acc: 0.1433	Train loss: 0.0357	Test Acc: 0.1046	Test loss: 0.0360
Epoch 22 	Train Acc: 0.1448	Train loss: 0.0363	Test Acc: 0.1035	Test loss: 0.0359
Epoch 23 	Train Acc: 0.1426	Train loss: 0.0401	Test Acc: 0.1032	Test loss: 0.0359
Epoch 24 	Train Acc: 0.1335	Train loss: 0.0405	Test Acc: 0.1030	Test loss: 0.0359
Epoch 25 	Train Acc: 0.1344	Train loss: 0.0355	Test Acc: 0.1029	Test loss: 0.0359
Epoch 26 	Train Acc: 0.1354	Train loss: 0.0355	Test Acc: 0.1029	Test loss: 0.0359
Epoch 27 	Train Acc: 0.1408	Train loss: 0.0439	Test Acc: 0.1028	Test loss: 0.0359
Epoch 28 	Train Acc: 0.1271	Train loss: 0.0356	Test Acc: 0.1028	Test loss: 0.0359
Epoch 29 	Train Acc: 0.1341	Train loss: 0.0370	Test Acc: 0.1028	Test loss: 0.0358
Epoch 30 	Train Acc: 0.1266	Train loss: 0.0354	Test Acc: 0.1028	Test loss: 0.0358
Epoch 31 	Train Acc: 0.1381	Train loss: 0.0397	Test Acc: 0.1028	Test loss: 0.0358
Epoch 32 	Train Acc: 0.1448	Train loss: 0.0353	Test Acc: 0.1028	Test loss: 0.0358
Epoch 33 	Train Acc: 0.1441	Train loss: 0.0362	Test Acc: 0.1028	Test loss: 0.0358
Epoch 34 	Train Acc: 0.1313	Train loss: 0.0421	Test Acc: 0.1028	Test loss: 0.0357
Epoch 35 	Train Acc: 0.1433	Train loss: 0.0407	Test Acc: 0.1028	Test loss: 0.0357
Epoch 36 	Train Acc: 0.1380	Train loss: 0.0396	Test Acc: 0.1028	Test loss: 0.0357
Epoch 37 	Train Acc: 0.1311	Train loss: 0.0478	Test Acc: 0.1032	Test loss: 0.0357
Epoch 38 	Train Acc: 0.1380	Train loss: 0.0349	Test Acc: 0.1037	Test loss: 0.0356
Epoch 39 	Train Acc: 0.1403	Train loss: 0.0372	Test Acc: 0.1050	Test loss: 0.0356
Epoch 40 	Train Acc: 0.1349	Train loss: 0.0348	Test Acc: 0.1078	Test loss: 0.0356
Epoch 41 	Train Acc: 0.1450	Train loss: 0.0410	Test Acc: 0.1128	Test loss: 0.0355
Epoch 42 	Train Acc: 0.1318	Train loss: 0.0347	Test Acc: 0.1223	Test loss: 0.0355
Epoch 43 	Train Acc: 0.1522	Train loss: 0.0346	Test Acc: 0.1357	Test loss: 0.0354
Epoch 44 	Train Acc: 0.1832	Train loss: 0.0360	Test Acc: 0.1519	Test loss: 0.0353
Epoch 45 	Train Acc: 0.1846	Train loss: 0.0348	Test Acc: 0.1690	Test loss: 0.0352
Epoch 46 	Train Acc: 0.2263	Train loss: 0.0354	Test Acc: 0.1854	Test loss: 0.0351
Epoch 47 	Train Acc: 0.2345	Train loss: 0.0427	Test Acc: 0.2015	Test loss: 0.0350
Epoch 48 	Train Acc: 0.2416	Train loss: 0.0413	Test Acc: 0.2212	Test loss: 0.0349
Epoch 49 	Train Acc: 0.2728	Train loss: 0.0380	Test Acc: 0.2461	Test loss: 0.0348
Epoch 50 	Train Acc: 0.2878	Train loss: 0.0343	Test Acc: 0.2717	Test loss: 0.0346
Epoch 51 	Train Acc: 0.3167	Train loss: 0.0332	Test Acc: 0.2967	Test loss: 0.0344
Epoch 52 	Train Acc: 0.3656	Train loss: 0.0328	Test Acc: 0.3159	Test loss: 0.0341
Epoch 53 	Train Acc: 0.3578	Train loss: 0.0369	Test Acc: 0.3379	Test loss: 0.0338
Epoch 54 	Train Acc: 0.3767	Train loss: 0.0324	Test Acc: 0.3562	Test loss: 0.0335
Epoch 55 	Train Acc: 0.4194	Train loss: 0.0395	Test Acc: 0.3887	Test loss: 0.0331
Epoch 56 	Train Acc: 0.4646	Train loss: 0.0416	Test Acc: 0.4159	Test loss: 0.0327
Epoch 57 	Train Acc: 0.4698	Train loss: 0.0310	Test Acc: 0.4479	Test loss: 0.0321
Epoch 58 	Train Acc: 0.4881	Train loss: 0.0310	Test Acc: 0.4730	Test loss: 0.0315
Epoch 59 	Train Acc: 0.5316	Train loss: 0.0327	Test Acc: 0.4911	Test loss: 0.0309
Epoch 60 	Train Acc: 0.5448	Train loss: 0.0289	Test Acc: 0.4995	Test loss: 0.0302
Epoch 61 	Train Acc: 0.5521	Train loss: 0.0279	Test Acc: 0.5056	Test loss: 0.0294
Epoch 62 	Train Acc: 0.5465	Train loss: 0.0355	Test Acc: 0.5292	Test loss: 0.0284
Epoch 63 	Train Acc: 0.5877	Train loss: 0.0289	Test Acc: 0.5586	Test loss: 0.0273
Epoch 64 	Train Acc: 0.5984	Train loss: 0.0252	Test Acc: 0.5969	Test loss: 0.0262
Epoch 65 	Train Acc: 0.6190	Train loss: 0.0243	Test Acc: 0.6277	Test loss: 0.0250
Epoch 66 	Train Acc: 0.6589	Train loss: 0.0227	Test Acc: 0.6523	Test loss: 0.0239
Epoch 67 	Train Acc: 0.6717	Train loss: 0.0221	Test Acc: 0.6641	Test loss: 0.0226
Epoch 68 	Train Acc: 0.6729	Train loss: 0.0209	Test Acc: 0.6746	Test loss: 0.0213
Epoch 69 	Train Acc: 0.7030	Train loss: 0.0245	Test Acc: 0.6911	Test loss: 0.0199
Epoch 70 	Train Acc: 0.7161	Train loss: 0.0178	Test Acc: 0.7012	Test loss: 0.0187
Epoch 71 	Train Acc: 0.7112	Train loss: 0.0204	Test Acc: 0.7037	Test loss: 0.0176
Epoch 72 	Train Acc: 0.7323	Train loss: 0.0186	Test Acc: 0.7078	Test loss: 0.0160
Epoch 73 	Train Acc: 0.7173	Train loss: 0.0169	Test Acc: 0.7042	Test loss: 0.0147
Epoch 74 	Train Acc: 0.7167	Train loss: 0.0170	Test Acc: 0.7085	Test loss: 0.0138
Epoch 75 	Train Acc: 0.7245	Train loss: 0.0166	Test Acc: 0.7148	Test loss: 0.0132
Epoch 76 	Train Acc: 0.7465	Train loss: 0.0151	Test Acc: 0.7305	Test loss: 0.0124
Epoch 77 	Train Acc: 0.7312	Train loss: 0.0128	Test Acc: 0.7383	Test loss: 0.0122
Epoch 78 	Train Acc: 0.7427	Train loss: 0.0120	Test Acc: 0.7288	Test loss: 0.0122
Epoch 79 	Train Acc: 0.7499	Train loss: 0.0119	Test Acc: 0.7288	Test loss: 0.0126
Epoch 80 	Train Acc: 0.7516	Train loss: 0.0118	Test Acc: 0.7385	Test loss: 0.0121
Epoch 81 	Train Acc: 0.7677	Train loss: 0.0113	Test Acc: 0.7578	Test loss: 0.0113
Epoch 82 	Train Acc: 0.7807	Train loss: 0.0115	Test Acc: 0.7696	Test loss: 0.0108
Epoch 83 	Train Acc: 0.7931	Train loss: 0.0137	Test Acc: 0.7676	Test loss: 0.0107
Epoch 84 	Train Acc: 0.7888	Train loss: 0.0106	Test Acc: 0.7860	Test loss: 0.0101
Epoch 85 	Train Acc: 0.8000	Train loss: 0.0099	Test Acc: 0.8050	Test loss: 0.0097
Epoch 86 	Train Acc: 0.8074	Train loss: 0.0098	Test Acc: 0.8086	Test loss: 0.0097
Epoch 87 	Train Acc: 0.8039	Train loss: 0.0106	Test Acc: 0.7871	Test loss: 0.0100
Epoch 88 	Train Acc: 0.8016	Train loss: 0.0102	Test Acc: 0.7709	Test loss: 0.0105
Epoch 89 	Train Acc: 0.8140	Train loss: 0.0111	Test Acc: 0.7847	Test loss: 0.0100
Epoch 90 	Train Acc: 0.8068	Train loss: 0.0124	Test Acc: 0.7879	Test loss: 0.0101
Epoch 91 	Train Acc: 0.7997	Train loss: 0.0102	Test Acc: 0.8045	Test loss: 0.0097
Epoch 92 	Train Acc: 0.8073	Train loss: 0.0094	Test Acc: 0.8287	Test loss: 0.0088
Epoch 93 	Train Acc: 0.8515	Train loss: 0.0083	Test Acc: 0.8089	Test loss: 0.0089
Epoch 94 	Train Acc: 0.8282	Train loss: 0.0112	Test Acc: 0.8078	Test loss: 0.0090
Epoch 95 	Train Acc: 0.8244	Train loss: 0.0134	Test Acc: 0.7965	Test loss: 0.0094
Epoch 96 	Train Acc: 0.8161	Train loss: 0.0083	Test Acc: 0.7913	Test loss: 0.0095
Epoch 97 	Train Acc: 0.8187	Train loss: 0.0122	Test Acc: 0.8073	Test loss: 0.0087
Epoch 98 	Train Acc: 0.8291	Train loss: 0.0084	Test Acc: 0.8131	Test loss: 0.0085
Epoch 99 	Train Acc: 0.8315	Train loss: 0.0086	Test Acc: 0.8295	Test loss: 0.0080
Epoch 100	Train Acc: 0.8385	Train loss: 0.0078	Test Acc: 0.8233	Test loss: 0.0083
Epoch 101	Train Acc: 0.8351	Train loss: 0.0084	Test Acc: 0.8196	Test loss: 0.0083
Epoch 102	Train Acc: 0.8375	Train loss: 0.0077	Test Acc: 0.8188	Test loss: 0.0083
Epoch 103	Train Acc: 0.8479	Train loss: 0.0070	Test Acc: 0.8174	Test loss: 0.0082
Epoch 104	Train Acc: 0.8508	Train loss: 0.0082	Test Acc: 0.8222	Test loss: 0.0081
Epoch 105	Train Acc: 0.8438	Train loss: 0.0076	Test Acc: 0.8227	Test loss: 0.0080
Epoch 106	Train Acc: 0.8359	Train loss: 0.0081	Test Acc: 0.8328	Test loss: 0.0077
Epoch 107	Train Acc: 0.8457	Train loss: 0.0098	Test Acc: 0.8453	Test loss: 0.0074
Epoch 108	Train Acc: 0.8505	Train loss: 0.0071	Test Acc: 0.8468	Test loss: 0.0074
Epoch 109	Train Acc: 0.8431	Train loss: 0.0076	Test Acc: 0.8453	Test loss: 0.0072
Epoch 110	Train Acc: 0.8604	Train loss: 0.0075	Test Acc: 0.8318	Test loss: 0.0076
Epoch 111	Train Acc: 0.8582	Train loss: 0.0081	Test Acc: 0.8282	Test loss: 0.0076
Epoch 112	Train Acc: 0.8458	Train loss: 0.0074	Test Acc: 0.8504	Test loss: 0.0071
Epoch 113	Train Acc: 0.8580	Train loss: 0.0109	Test Acc: 0.8405	Test loss: 0.0078
Epoch 114	Train Acc: 0.8527	Train loss: 0.0070	Test Acc: 0.8490	Test loss: 0.0071
Epoch 115	Train Acc: 0.8624	Train loss: 0.0071	Test Acc: 0.8299	Test loss: 0.0075
Epoch 116	Train Acc: 0.8401	Train loss: 0.0070	Test Acc: 0.8437	Test loss: 0.0071
Epoch 117	Train Acc: 0.8657	Train loss: 0.0064	Test Acc: 0.8628	Test loss: 0.0066
Epoch 118	Train Acc: 0.8764	Train loss: 0.0084	Test Acc: 0.8505	Test loss: 0.0070
Epoch 119	Train Acc: 0.8561	Train loss: 0.0086	Test Acc: 0.8468	Test loss: 0.0070
Epoch 120	Train Acc: 0.8669	Train loss: 0.0062	Test Acc: 0.8445	Test loss: 0.0070
Epoch 121	Train Acc: 0.8630	Train loss: 0.0063	Test Acc: 0.8541	Test loss: 0.0067
Epoch 122	Train Acc: 0.8578	Train loss: 0.0066	Test Acc: 0.8630	Test loss: 0.0067
Epoch 123	Train Acc: 0.8635	Train loss: 0.0068	Test Acc: 0.8651	Test loss: 0.0065
